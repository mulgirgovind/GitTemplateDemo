Some code level changes done in this PR.
